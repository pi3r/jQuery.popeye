(function(a){a.fn.popeye=function(c){var d=a.extend({},a.fn.popeye.defaults,c);function b(f,e){if(window.console&&window.console.log&&d.debug){if(e=="info"&&window.console.info){window.console.info(f)}else{if(e=="warn"&&window.console.warn){window.console.warn(f)}else{window.console.log(f)}}}}return this.each(function(){a(this).addClass("ppy-active");var v=a(this),n=v.find(".ppy-imglist > li > a > img"),W=v.find(".ppy-imglist > li > a"),j=n.length,k=(j==1)?true:false,q=false,m=0,A="ppy-expanded",e="ppy-loading",J="ppy-single-image",V=a('<div class="ppy-placeholder"></div>'),s=a('<div class="ppy-stagewrap"></div>'),M=a('<div class="ppy-captionwrap"></div>'),u=v.find(".ppy-outer"),E=v.find(".ppy-stage"),T=v.find(".ppy-nav"),C=v.find(".ppy-prev"),U=v.find(".ppy-next"),r=v.find(".ppy-switch-enlarge"),P=v.find(".ppy-switch-compact").addClass("ppy-hidden"),h=v.find(".ppy-caption"),x=v.find(".ppy-text"),D=v.find(".ppy-counter"),O=v.find(".ppy-current"),Q=v.find(".ppy-total"),o={position:"absolute",width:"auto",height:"auto",margin:0,top:0,left:(d.direction=="right")?0:"auto",right:(d.direction=="left")?0:"auto"},y={height:E.height(),width:E.width()},p={height:h.height()},w={height:(d.caption=="hover"||false)?u.outerHeight():v.outerHeight(),width:(d.caption=="hover"||false)?u.outerWidth():v.outerWidth(),"float":v.css("float"),marginTop:v.css("margin-top"),marginRight:v.css("margin-right"),marginBottom:v.css("margin-bottom"),marginLeft:v.css("margin-left")};var K=[];for(var S=0;S<n.length;S++){var H=v.find(".ppy-imglist li").eq(S).find(".ppy-extcaption");K[S]=H.length>0?H.html():n[S].alt}if(!E.length||!T.length||!u.length){b("$.fn.popeye: Incorrect HTML structure","warn")}else{if(j===0){b("$.fn.popeye: No images found","warn")}else{k?b("$.fn.popeye -> SingleImageMode started"):b("$.fn.popeye -> "+j+" thumbnails found.");R()}}function B(Y,ac){ac=ac||false;Y=Y||m;var aa={backgroundImage:"url("+n[Y].src+")"};var ab={height:"+=0"};if(q){z();E.fadeTo((d.duration/2),0).animate(y,{queue:false,duration:d.duration,easing:d.easing,complete:function(){q=false;b("$.fn.showThumb: Entering COMPACT MODE","info");v.removeClass(A);v.css("z-index","");r.removeClass("ppy-hidden");P.addClass("ppy-hidden");B();a(this).fadeTo((d.duration/2),1)}})}else{if(ac){s.addClass(e);E.fadeTo((d.duration/2),0);var Z=new Image();Z.onload=function(){b("$.fn.popeye.showThumb: Thumbnail "+Y+" loaded","info");s.removeClass(e);E.animate(ab,1,"linear",function(){E.css(aa);a(this).fadeTo((d.duration/2),1);if(d.caption=="hover"){g(K[Y])}else{if(d.caption=="permanent"){l(K[Y])}}F()});Z.onload=function(){}};Z.src=n[Y].src}else{E.css(aa);F();g(K[Y],true)}var X=new Image();X.onload=function(){b("$.fn.popeye.showThumb: Image "+Y+" loaded","info");X.onload=function(){}};X.src=W[Y].href}}function L(Z){Z=Z||m;s.addClass(e);E.fadeTo((d.duration/2),0);var X=a("."+A);X.css("z-index",d.zindex-1);v.css("z-index",d.zindex);var Y=new Image();Y.onload=function(){s.removeClass(e);var i={width:Y.width,height:Y.height};var aa={backgroundImage:"url("+W[Z].href+")",backgroundPosition:"left top"};z();E.animate(i,{queue:false,duration:d.duration,easing:d.easing,complete:function(){if(d.navigation=="hover"){G()}q=true;b("$.fn.popeye.showImage: Entering ENLARGED MODE","info");v.addClass(A);P.removeClass("ppy-hidden");r.addClass("ppy-hidden");F();a(this).css(aa).fadeTo((d.duration/2),1);g(K[Z]);t()}})};Y.src=W[Z].href}function F(X){X=X||m;Q.text(j);O.text(X+1);b("$.fn.popeye.updateCounter: Displaying image "+(X+1)+" of "+j)}function t(Y){Y=Y||m;var Z=new Image();var aa=new Image();var X=Y;if(X<(j-1)){X++}else{X=0}Z.src=W[Y].href[X];X=Y;if(X<=0){X=j-1}else{X--}aa.src=W[Y].href[X]}function G(){T.stop().fadeTo(150,d.opacity)}function I(){T.stop().fadeTo(150,0)}function l(i){if(d.caption){x.html(i)}}function g(i,Y){if(i&&d.caption){l(i);b("$.fn.popeye.showCaption -> ppyCaptionWrap.outerHeight(true): "+M.outerHeight(true));var X={visibility:"visible"};h.css(X);if(d.caption==="permanent"&&!q){h.css(p)}else{h.animate({height:M.outerHeight(true)},{queue:false,duration:90,easing:d.easing})}}else{if(!i&&!Y){z()}}}function z(){var i={visibility:"hidden",overflow:"hidden"};h.animate({height:"0px"},{queue:false,duration:90,easing:d.easing,complete:function(){h.css(i)}})}function N(){if(m<=0){m=j-1}else{m--}if(q){L(m)}else{B(m,true)}return m}function f(){if(m<(j-1)){m++}else{m=0}if(q){L(m)}else{B(m,true)}return m}function R(){V.css(w);v.css(o);v.wrap(V);s=E.wrap(s).parent();M=h.wrapInner(M).children().eq(0);B();if(d.navigation=="hover"){I();v.hover(function(){G()},function(){I()});T.hover(function(){G()},function(){I()})}if(!k){C.click(N);U.click(f)}else{v.addClass(J);C.remove();U.remove();D.remove()}if(d.caption=="hover"){z();v.hover(function(){g(K[m])},function(){z(true)})}r.click(function(){L();return false});P.click(function(){B(m);return false})}})};a.fn.popeye.defaults={navigation:"hover",caption:"hover",zindex:10000,direction:"right",duration:240,opacity:0.8,easing:"swing",debug:false}})(jQuery);jQuery("head").append('<style type="text/css"> .ppy-imglist { position: absolute; top: -1000em; left: -1000em; } </style>');